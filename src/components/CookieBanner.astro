---
---

<div
  id="cookie-banner"
  class="fixed bottom-6 left-6 right-6 md:left-auto md:right-8 md:max-w-md z-[100] transform translate-y-20 opacity-0 transition-all duration-700 ease-out pointer-events-none"
>
  <div
    class="bg-white/80 backdrop-blur-xl border border-gray-200/50 rounded-[32px] p-6 shadow-[0_20px_50px_rgba(0,0,0,0.1)]"
  >
    <div class="flex flex-col gap-4">
      <div class="flex items-start gap-4">
        <div class="bg-blue-50 p-3 rounded-2xl text-primary">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="24"
            height="24"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
          >
            <path d="M12 2a10 10 0 1 0 10 10 4 4 0 0 1-5-5 4 4 0 0 1-5-5"
            ></path>
            <path d="M8.5 8.5v.01"></path>
            <path d="M16 15.5v.01"></path>
            <path d="M12 12v.01"></path>
            <path d="M11 17v.01"></path>
            <path d="M7 14v.01"></path>
          </svg>
        </div>
        <div class="flex-1">
          <h3 class="text-gray-900 font-bold text-lg leading-tight mb-1">
            Tu privacidad nos importa
          </h3>
          <p class="text-gray-500 text-sm leading-relaxed">
            Utilizamos cookies para mejorar tu experiencia y analizar nuestro
            tráfico. Al hacer clic en "Aceptar", consientes su uso.
          </p>
        </div>
      </div>

      <div class="flex flex-col sm:flex-row gap-3 mt-2">
        <button
          id="accept-cookies"
          class="flex-1 bg-primary text-white font-bold py-3 px-6 rounded-2xl hover:bg-primary-700 transition-all duration-300 shadow-md shadow-primary/20 hover:shadow-lg hover:scale-[1.02] active:scale-[0.98] cursor-pointer"
        >
          Aceptar todas
        </button>
        <button
          id="decline-cookies"
          class="flex-1 bg-gray-100 text-gray-600 font-semibold py-3 px-6 rounded-2xl hover:bg-gray-200 transition-all duration-300 cursor-pointer"
        >
          Solo necesarias
        </button>
      </div>

      <div class="text-center">
        <a
          href="/politica-cookies"
          class="text-gray-400 hover:text-primary text-xs font-medium transition-colors"
        >
          Leer política de cookies
        </a>
      </div>
    </div>
  </div>
</div>

<script>
  function initCookieBanner() {
    const banner = document.getElementById("cookie-banner");
    const acceptBtn = document.getElementById("accept-cookies");
    const declineBtn = document.getElementById("decline-cookies");

    if (!banner || !acceptBtn || !declineBtn) return;

    // Check if user has already made a choice
    const cookieConsent = localStorage.getItem("cookie-consent");

    if (!cookieConsent) {
      // Show banner after short delay
      setTimeout(() => {
        banner.classList.remove(
          "translate-y-20",
          "opacity-0",
          "pointer-events-none",
        );
      }, 1000);
    }

    const hideBanner = () => {
      banner.classList.add(
        "translate-y-20",
        "opacity-0",
        "pointer-events-none",
      );
    };

    acceptBtn.addEventListener("click", () => {
      localStorage.setItem("cookie-consent", "accepted");
      hideBanner();
    });

    declineBtn.addEventListener("click", () => {
      localStorage.setItem("cookie-consent", "declined");
      hideBanner();
    });
  }

  // Run on page load and after view transitions
  initCookieBanner();
  document.addEventListener("astro:after-swap", initCookieBanner);
</script>

<style>
  #cookie-banner {
    /* Safe area for mobile browsers */
    bottom: calc(env(safe-area-inset-bottom) + 1.5rem);
  }
</style>
