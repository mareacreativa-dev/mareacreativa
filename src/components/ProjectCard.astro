---
import { MousePointerClick } from "lucide-react";

export interface Props {
  title: string;
  description: string;
  image: string;
  url?: string;
  tags?: string[];
  pais?: string;
}

const {
  title,
  description,
  image,
  url,
  tags = [],
  pais = "EspaÃ±a",
} = Astro.props;

// Diccionario de banderas
const flags: Record<string, string> = {
  EspaÃ±a: "ğŸ‡ªğŸ‡¸",
  EEUU: "ğŸ‡ºğŸ‡¸",
  MÃ©xico: "ğŸ‡²ğŸ‡½",
  Colombia: "ğŸ‡¨ğŸ‡´",
  Argentina: "ğŸ‡¦ğŸ‡·",
  PerÃº: "ğŸ‡µğŸ‡ª",
  Chile: "ğŸ‡¨ğŸ‡±",
};

const TagComponent = url ? "a" : "div";
const linkProps = url
  ? { href: url, target: "_blank", rel: "noopener noreferrer" }
  : {};
---

<TagComponent
  {...linkProps}
  class={`group relative bg-white border border-gray-100 rounded-[28px] overflow-hidden shadow-sm hover:shadow-[0_20px_40px_-15px_rgba(0,0,0,0.1)] hover:-translate-y-1 transition-all duration-500 flex flex-col h-full ${
    url ? "cursor-pointer" : ""
  }`}
>
  <!-- Efecto marco moderno con padding -->
  <div class="relative w-full p-2 pb-0">
    <div
      class="relative w-full aspect-video rounded-[20px] overflow-hidden bg-gray-50 shadow-inner"
    >
      <img
        src={image}
        alt={title}
        class="w-full h-full object-cover object-top transition-transform duration-700 ease-out group-hover:scale-105"
        draggable="false"
        loading="lazy"
      />

      <!-- Overlay interactivo sutil -->
      <div
        class="absolute inset-0 bg-primary/0 group-hover:bg-primary/10 transition-colors duration-500 z-0"
      >
      </div>

      <!-- Icono de acciÃ³n flotante (estilo Apple) -->
      {
        url && (
          <div class="absolute top-4 right-4 bg-white/90 backdrop-blur-md text-primary w-10 h-10 rounded-full flex items-center justify-center opacity-0 group-hover:opacity-100 shadow-md transform scale-75 group-hover:scale-100 transition-all duration-500 z-10 border border-white/50">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              class="w-5 h-5"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
            >
              <path d="M7 17L17 7" />
              <path d="M7 7h10v10" />
            </svg>
          </div>
        )
      }
    </div>
  </div>

  <div class="p-5 pt-4 flex flex-col flex-grow">
    <div class="flex items-center justify-between gap-3 mb-2">
      <h2
        class="text-xl font-bold tracking-tight text-gray-900 group-hover:text-primary transition-colors line-clamp-1"
      >
        {title}
      </h2>
      {
        flags[pais] && (
          <span
            class="text-lg bg-gray-50 border border-gray-100 px-2 py-1 flex items-center justify-center rounded-xl shadow-sm"
            title={pais}
          >
            {flags[pais]}
          </span>
        )
      }
    </div>

    <p
      class="text-gray-500 mb-4 text-xs leading-relaxed flex-grow line-clamp-3"
    >
      {description}
    </p>

    {
      tags.length > 0 && (
        <div class="flex flex-wrap gap-1.5 mt-auto pt-4 border-t border-gray-50">
          {tags.map((tag) => (
            <span class="bg-blue-50/50 text-blue-700 font-semibold text-[10px] px-2.5 py-1 rounded-full border border-blue-100/50">
              {tag}
            </span>
          ))}
        </div>
      )
    }
  </div>
</TagComponent>
