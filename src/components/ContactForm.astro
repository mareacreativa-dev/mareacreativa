<div
  class="bg-white border-2 border-[#0e44f9]/20 p-6 md:p-8 lg:p-10 rounded-[24px] md:rounded-[32px] shadow-2xl shadow-blue-900/5 relative z-20"
>
  <div class="mb-8 lg:mb-10">
    <h2
      class="text-2xl md:text-3xl font-bold text-gray-900 mb-2 tracking-tight"
    >
      Formulario Directo
    </h2>
    <p class="text-gray-500 text-base">
      ¿Preparado para arrancar? Cuéntanos tu desafío y nos pondremos en
      contacto.
    </p>
  </div>

  <form id="contactForm" class="space-y-5">
    <div class="grid grid-cols-1 md:grid-cols-2 gap-5">
      <div>
        <label
          for="name"
          class="block text-xs font-semibold text-gray-700 mb-2 uppercase tracking-wide"
        >
          Nombre completo
        </label>
        <input
          type="text"
          id="name"
          name="firstname"
          placeholder="Ej: Laura Méndez"
          class="w-full px-4 py-3 text-sm bg-gray-50 border-transparent rounded-[12px] focus:bg-white focus:ring-2 focus:ring-blue-600 focus:border-transparent transition-all outline-none"
          required
        />
      </div>
      <div>
        <label
          for="email"
          class="block text-xs font-semibold text-gray-700 mb-2 uppercase tracking-wide"
        >
          Correo Electrónico
        </label>
        <input
          type="email"
          id="email"
          name="email"
          placeholder="hola@tuempresa.com"
          class="w-full px-4 py-3 text-sm bg-gray-50 border-transparent rounded-[12px] focus:bg-white focus:ring-2 focus:ring-blue-600 focus:border-transparent transition-all outline-none"
          required
        />
      </div>
    </div>

    <div>
      <label
        for="phone"
        class="block text-xs font-semibold text-gray-700 mb-2 uppercase tracking-wide"
      >
        Teléfono <span class="text-gray-400 font-normal lowercase"
          >(opcional)</span
        >
      </label>
      <input
        type="text"
        id="phone"
        name="telefono"
        placeholder="+34 600 000 000"
        class="w-full px-4 py-3 text-sm bg-gray-50 border-transparent rounded-[12px] focus:bg-white focus:ring-2 focus:ring-blue-600 focus:border-transparent transition-all outline-none"
      />
    </div>

    <div>
      <label
        for="message"
        class="block text-xs font-semibold text-gray-700 mb-2 uppercase tracking-wide"
      >
        Detalles del proyecto
      </label>
      <textarea
        id="message"
        name="descripcion"
        rows="3"
        placeholder="Háblanos sobre los problemas actuales y tus metas a lograr..."
        class="w-full px-4 py-3 text-sm bg-gray-50 border-transparent rounded-[12px] focus:bg-white focus:ring-2 focus:ring-blue-600 focus:border-transparent transition-all outline-none resize-none"
        required></textarea>
    </div>

    <!-- Honeypot (Anti-Spam invisible para usuarios) -->
    <div class="absolute left-[-5000px]" aria-hidden="true">
      <input
        type="text"
        id="website_url"
        name="website_url"
        tabindex="-1"
        autocomplete="off"
        placeholder="Deja este campo en blanco"
      />
    </div>

    <button
      type="submit"
      class="w-full flex items-center justify-center gap-2 bg-[#0e44f9] text-white font-semibold text-base px-6 py-4 rounded-full hover:bg-blue-700 transition-all shadow-xl shadow-blue-500/20 active:scale-[0.98]"
    >
      <span>Enviar Solicitud</span>
      <svg
        xmlns="http://www.w3.org/2000/svg"
        width="18"
        height="18"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
      >
        <line x1="22" y1="2" x2="11" y2="13"></line>
        <polygon points="22 2 15 22 11 13 2 9 22 2"></polygon>
      </svg>
    </button>

    <p
      id="responseMessage"
      class="mt-5 text-center text-sm font-semibold text-[#0ebf6e] bg-[#0ebf6e]/10 py-3 rounded-[12px] hidden"
    >
      ¡Solicitud enviada! Nos pondremos en contacto pronto.
    </p>
  </form>
</div>

<script>
  async function enviarAFormSubmit(datos) {
    const url = "https://formsubmit.co/ajax/8d86a7e2a5da3f4edcc0272444052849";

    const data = {
      Nombre: datos.name,
      Email: datos.email,
      Teléfono: datos.phone || "No proporcionado",
      "Detalles del Proyecto": datos.message,
      _subject: `Nueva solicitud de proyecto de ${datos.name}`,
      _template: "box",
    };

    const response = await fetch(url, {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        Accept: "application/json",
      },
      body: JSON.stringify(data),
    });

    if (!response.ok) {
      throw new Error("Error enviando el correo");
    }
  }

  document
    .getElementById("contactForm")
    .addEventListener("submit", async function (event) {
      event.preventDefault();
      const form = event.target;
      const honeypotInput = document.getElementById("website_url").value;

      // Si el honeypot (campo oculto) contiene texto, es un bot.
      if (honeypotInput !== "") {
        console.warn("Spam detectado y bloqueado.");
        return; // Salimos de la función silenciosamente
      }

      const btn = form.querySelector('button[type="submit"]');
      const oldText = btn.innerHTML;
      btn.innerHTML = "Enviando...";
      btn.disabled = true;

      const datosFormulario = {
        name: document.getElementById("name").value,
        email: document.getElementById("email").value,
        phone: document.getElementById("phone").value,
        message: document.getElementById("message").value,
      };

      try {
        await enviarAFormSubmit(datosFormulario);

        document.getElementById("responseMessage").classList.remove("hidden");
        form.reset();
      } catch (error) {
        console.error("Error al enviar el mensaje:", error);
        alert("Hubo un error al enviar el formulario. Inténtalo de nuevo.");
      } finally {
        btn.innerHTML = oldText;
        btn.disabled = false;
      }
    });
</script>
